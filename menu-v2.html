<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sankalp Manowara Wedding Reception Menu - Veg Gold Selection</title>

  <style>
    :root{
      --border:#e5e7eb;
      --text:#111827;
      --muted:#6b7280;
      --bg:#ffffff;
      --chip:#eef2ff;
      --chipborder:#c7d2fe;
      --chiptext:#3730a3;
    }
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background:#f8fafc;
    }
    .wrap{ max-width:1100px; margin:18px auto; padding:0 12px 24px; }
    .card{
      background:var(--bg);
      border:1px solid var(--border);
      border-radius:14px;
      box-shadow:0 1px 3px rgba(0,0,0,.04);
    }
    header.card{ padding:14px 14px 10px; }
    h1{ font-size:18px; margin:0 0 10px; line-height:1.25; }

    .topbar{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .topbar input{
      flex:1 1 260px;
      border:1px solid var(--border);
      border-radius:10px;
      padding:10px 12px;
      font-size:13px;
      outline:none;
      background:#fff;
    }
    .btn{
      border:1px solid var(--border);
      border-radius:10px;
      padding:10px 12px;
      font-size:13px;
      cursor:pointer;
      white-space:nowrap;
      background:#fff;
      color:var(--text);
    }
    .btn-primary{
      background:#111827;
      color:#fff;
      border-color:#111827;
    }
    .btn-primary:hover{ background:#0b1220; }
    .btn:hover{ background:#f9fafb; }
    .status{ margin-top:8px; font-size:12px; color:var(--muted); min-height:16px; }

    .table-wrap{ margin-top:12px; border-radius:14px; overflow:hidden; }
    table{ width:100%; border-collapse:collapse; table-layout:fixed; }
    thead th{
      background:#f9fafb;
      border-bottom:1px solid var(--border);
      text-align:left;
      font-size:12px;
      color:var(--muted);
      padding:10px 10px;
    }
    tbody td{
      border-bottom:1px solid var(--border);
      padding:10px 10px;
      font-size:13px;
      vertical-align:top;
      background:#fff;
      word-wrap:break-word;
    }
    tbody tr:last-child td{ border-bottom:none; }

    /* Desktop column widths */
    th.col-cat, td.col-cat{ width:28%; }
    th.col-dish, td.col-dish{ width:55%; }
    th.col-sel, td.col-sel{ width:7%; text-align:center; }
    th.col-score, td.col-score{ width:10%; }

    .cat{
      color:var(--muted);
      font-weight:700;
      font-size:12px;
      line-height:1.25;
    }
    .cat .rule{ font-weight:600; color:#374151; }

    .lko{
      font-size:11px;
      padding:2px 8px;
      border-radius:999px;
      background:var(--chip);
      border:1px solid var(--chipborder);
      color:var(--chiptext);
      font-weight:700;
      margin-left:6px;
      display:inline-block;
    }
    input[type="checkbox"]{ width:18px; height:18px; cursor:pointer; }
    .score{ font-variant-numeric:tabular-nums; }

    /* Hide the mobile helper on desktop */
    .mobile-cat{ display:none; }

    /* SUMMARY VIEW */
    .hidden{ display:none !important; }
    .summary-card{ padding:14px; }
    .summary-header{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    .summary-header h2{ margin:0; font-size:16px; }
    .summary-meta{ color:var(--muted); font-size:12px; margin-top:6px; }
    .kpi{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 10px;
      border:1px solid var(--border);
      border-radius:999px;
      font-size:12px;
      color:var(--muted);
      background:#fff;
    }
    .pill strong{ color:var(--text); }

    .summary-grid{ display:grid; grid-template-columns:1fr; gap:12px; margin-top:12px; }
    .summary-box{
      border:1px solid var(--border);
      border-radius:12px;
      padding:12px;
      background:#fff;
    }
    .summary-box h3{ margin:0 0 8px; font-size:13px; color:#111827; }
    .summary-list{ margin:0; padding-left:18px; color:#111827; }
    .summary-list li{ margin:6px 0; }

    /* MOBILE: stacked layout with Selected + Popularity side-by-side, no Hotel column */
    @media (max-width:720px){
      thead{ display:none; }
      table, tbody, tr, td{ display:block; width:100%; }
      tbody tr{ border-bottom:10px solid #f8fafc; }
      tbody td{ border-bottom:none; }

      /* Hide desktop columns on mobile */
      td.col-cat{ display:none; }
      td.col-sel{ display:none; }
      td.col-score{ display:none; }

      td.col-dish{ padding:12px 12px 12px; }

      /* Show category+rule inside the dish cell on mobile only */
      .mobile-cat{
        display:block;
        font-size:12px;
        color:var(--muted);
        font-weight:700;
        margin-bottom:6px;
      }
      .mobile-cat .rule{ font-weight:600; color:#374151; }

      .mobile-controls{
        display:flex;
        justify-content:space-between;
        gap:12px;
        margin-top:10px;
        padding-top:10px;
        border-top:1px solid var(--border);
        align-items:center;
      }
      .mobile-controls .left,
      .mobile-controls .right{
        display:flex;
        align-items:center;
        gap:8px;
        font-size:12px;
        color:var(--muted);
        font-weight:600;
      }
      .mobile-controls .right .score-value{
        font-size:13px;
        color:var(--text);
        font-weight:700;
      }
    }

    /* PRINT/PDF */
    @media print{
      body{ background:#fff; }
      .wrap{ max-width:none; margin:0; padding:0; }
      #editView, #editHeaderActions{ display:none !important; }
      #summaryView{ display:block !important; border:none; box-shadow:none; }
      .card{ border:none; box-shadow:none; }
      .btn{ display:none !important; }
    }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- EDIT VIEW -->
    <header class="card" id="editView">
      <h1>Sankalp Manowara Wedding Reception Menu - Veg Gold Selection</h1>
      <div class="topbar" id="editHeaderActions">
        <input id="familyMember" type="text" placeholder="Enter your name (required)" />
        <button class="btn btn-primary" id="submitBtn">Submit</button>
        <button class="btn" id="clearBtn">Clear</button>
      </div>
      <div class="status" id="status"></div>

      <div class="card table-wrap" style="margin-top:12px;">
        <table>
          <thead>
            <tr>
              <th class="col-cat">Category</th>
              <th class="col-dish">Dish</th>
              <th class="col-sel">Selected</th>
              <th class="col-score">Popularity</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>
    </header>

    <!-- SUMMARY VIEW -->
    <div class="card hidden" id="summaryView">
      <div class="summary-card">
        <div class="summary-header">
          <div>
            <h2>Submission Summary</h2>
            <div class="summary-meta">
              <span id="sumName"></span> · <span id="sumTime"></span>
            </div>
            <div class="kpi">
              <span class="pill"><strong id="sumSelectedCount">0</strong> selected</span>
            </div>
          </div>
          <div style="display:flex; gap:10px; flex-wrap:wrap;">
            <button class="btn btn-primary" id="downloadPdfBtn">Download PDF</button>
            <button class="btn" id="backBtn">Back to edit</button>
          </div>
        </div>

        <div class="summary-grid">
          <div class="summary-box">
            <h3>Selected Dishes</h3>
            <ul class="summary-list" id="selectedList"></ul>
            <div class="summary-meta" id="selectedEmpty" style="display:none;">No dishes selected.</div>
          </div>
        </div>
      </div>
    </div>

  </div>

<script>
  const categoryRules = {
    "Welcome Drink": "Select 1",
    "Vegetarian Appetizers – Paneer": "Select 2 (within Starters)",
    "Vegetarian Appetizers – Veg / Awadhi": "Select 1 (within Starters)",
    "Vegetarian Appetizers – Fusion": "Select 1 (within Starters)",
    "Soup": "Select 1",
    "Salads": "Select 3",
    "Main Course – Paneer": "Select 1 (within Mains)",
    "Main Course – Festive Gravy": "Select 1 (within Mains)",
    "Main Course – Seasonal Vegetable": "Select 1 (within Mains)",
    "Lentil / Dal": "Select 1",
    "Rice Preparation": "Select 1",
    "Yogurt Preparation": "Select 1",
    "Indian Breads": "Select any 3",
    "Indian Dessert": "Select 1",
    "Western Dessert": "Select 1",
    "Ice Cream": "Select 1"
  };

  const rows = [
    { section:"Welcome Drink", dish:"Kesar Badam Milk (Warm)", lko:true, score:4.6 },
    { section:"Welcome Drink", dish:"Hot Aam Panna", score:4.2 },
    { section:"Welcome Drink", dish:"Strawberry Milk", score:4.0 },
    { section:"Welcome Drink", dish:"Jaljeera (Mild)", score:4.1 },

    { section:"Vegetarian Appetizers – Paneer", dish:"Paneer Malai Tikka", score:4.6 },
    { section:"Vegetarian Appetizers – Paneer", dish:"Paneer Amritsari", score:4.5 },
    { section:"Vegetarian Appetizers – Paneer", dish:"Paneer Kurkura", score:4.4 },
    { section:"Vegetarian Appetizers – Paneer", dish:"Achari Paneer Tikka", score:4.3 },

    { section:"Vegetarian Appetizers – Veg / Awadhi", dish:"Veg Galouti Kebab", lko:true, score:4.4 },
    { section:"Vegetarian Appetizers – Veg / Awadhi", dish:"Hara Bhara Kebab", score:4.3 },
    { section:"Vegetarian Appetizers – Veg / Awadhi", dish:"Dahi ke Kebab", score:4.2 },

    { section:"Vegetarian Appetizers – Fusion", dish:"Corn Cheese Balls", score:4.6 },
    { section:"Vegetarian Appetizers – Fusion", dish:"Cheese & Jalapeño Pockets", score:4.5 },
    { section:"Vegetarian Appetizers – Fusion", dish:"Veg Spring Rolls", score:4.4 },
    { section:"Vegetarian Appetizers – Fusion", dish:"Honey Chilli Potato", score:4.5 },

    { section:"Soup", dish:"Sweet Corn Vegetable Soup", score:4.4 },
    { section:"Soup", dish:"Tomato Dhaniya Shorba", score:4.3 },
    { section:"Soup", dish:"Cream of Mushroom Soup", score:4.1 },

    { section:"Salads", dish:"Green Salad", score:4.2 },
    { section:"Salads", dish:"Russian / Waldorf Salad", score:4.3 },
    { section:"Salads", dish:"Fruit Chaat", score:4.4 },
    { section:"Salads", dish:"Pasta Salad", score:4.1 },
    { section:"Salads", dish:"Sprout Salad", score:3.9 },

    { section:"Main Course – Paneer", dish:"Paneer Butter Masala", score:4.8 },
    { section:"Main Course – Paneer", dish:"Paneer Lababdar", score:4.7 },
    { section:"Main Course – Paneer", dish:"Shahi Paneer", score:4.6 },

    { section:"Main Course – Festive Gravy", dish:"Malai Kofta", score:4.7 },
    { section:"Main Course – Festive Gravy", dish:"Navratan Korma", score:4.6 },
    { section:"Main Course – Festive Gravy", dish:"Kaju Curry", score:4.5 },

    { section:"Main Course – Seasonal Vegetable", dish:"Dum Aloo Banarasi", lko:true, score:4.5 },
    { section:"Main Course – Seasonal Vegetable", dish:"Mix Veg Handi", score:4.3 },
    { section:"Main Course – Seasonal Vegetable", dish:"Aloo Mutter", score:4.2 },
    { section:"Main Course – Seasonal Vegetable", dish:"Seasonal Veg Curry", score:4.1 },

    { section:"Lentil / Dal", dish:"Dal Makhani", score:4.9 },
    { section:"Lentil / Dal", dish:"Dal Panchmel", score:4.4 },
    { section:"Lentil / Dal", dish:"Dal Tadka", score:4.3 },

    { section:"Rice Preparation", dish:"Veg Pulao", score:4.4 },
    { section:"Rice Preparation", dish:"Peas Pulao", score:4.3 },
    { section:"Rice Preparation", dish:"Jeera Rice", score:4.2 },

    { section:"Yogurt Preparation", dish:"Boondi Raita", score:4.3 },
    { section:"Yogurt Preparation", dish:"Mix Veg Raita", score:4.2 },
    { section:"Yogurt Preparation", dish:"Pineapple Raita", score:4.0 },

    { section:"Indian Breads", dish:"Butter Naan", score:4.8 },
    { section:"Indian Breads", dish:"Plain Roti", score:4.6 },
    { section:"Indian Breads", dish:"Laccha Paratha", score:4.7 },
    { section:"Indian Breads", dish:"Missi Roti", lko:true, score:4.5 },
    { section:"Indian Breads", dish:"Garlic Naan", score:4.6 },

    { section:"Indian Dessert", dish:"Gajar ka Halwa (Hot)", lko:true, score:4.9 },
    { section:"Indian Dessert", dish:"Gulab Jamun", score:4.8 },
    { section:"Indian Dessert", dish:"Moong Dal Halwa", score:4.6 },

    { section:"Western Dessert", dish:"Chocolate Truffle Pastry", score:4.3 },
    { section:"Western Dessert", dish:"Brownie with Chocolate Sauce", score:4.4 },
    { section:"Western Dessert", dish:"Red Velvet Pastry", score:4.2 },

    { section:"Ice Cream", dish:"Vanilla", score:4.3 },
    { section:"Ice Cream", dish:"Strawberry", score:4.1 },
    { section:"Ice Cream", dish:"Kesar Pista", score:4.2 },
  ];

  const state = {}; // id -> {selected}
  const tbody = document.getElementById("tbody");
  const statusEl = document.getElementById("status");
  const nameEl = document.getElementById("familyMember");

  const editView = document.getElementById("editView");
  const summaryView = document.getElementById("summaryView");

  const sumName = document.getElementById("sumName");
  const sumTime = document.getElementById("sumTime");
  const sumSelectedCount = document.getElementById("sumSelectedCount");
  const selectedList = document.getElementById("selectedList");
  const selectedEmpty = document.getElementById("selectedEmpty");

  const makeId = (s) => s.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");
  const esc = (s) => String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;");

  function initState(){
    rows.forEach(r => {
      const id = makeId(r.section + "-" + r.dish);
      state[id] = { selected:false };
    });
  }

  function computeSectionCounts(){
    const counts = {};
    rows.forEach(r => counts[r.section] = (counts[r.section] || 0) + 1);
    return counts;
  }

  function renderTable(){
    tbody.innerHTML = "";
    const counts = computeSectionCounts();
    const rendered = {};

    rows.forEach(r => {
      const id = makeId(r.section + "-" + r.dish);
      const st = state[id];

      const tr = document.createElement("tr");

      // Category cell once per section (desktop)
      if (!rendered[r.section]) {
        const tdCat = document.createElement("td");
        tdCat.className = "col-cat";
        tdCat.rowSpan = counts[r.section];
        const rule = categoryRules[r.section] ? ` · <span class="rule">${esc(categoryRules[r.section])}</span>` : "";
        tdCat.innerHTML = `<div class="cat">${esc(r.section)}${rule}</div>`;
        tr.appendChild(tdCat);
        rendered[r.section] = true;
      }

      // Dish cell: shows category+rule ONLY on mobile, plus mobile controls row
      const tdDish = document.createElement("td");
      tdDish.className = "col-dish";
      const ruleMobile = categoryRules[r.section] ? categoryRules[r.section] : "";

      tdDish.innerHTML =
        `<span class="mobile-cat">${esc(r.section)} · <span class="rule">${esc(ruleMobile)}</span></span>` +
        `<span class="dish-name">${esc(r.dish)}</span> ${r.lko ? '<span class="lko">LKO</span>' : ''}` +
        `<div class="mobile-controls">
          <div class="left">
            <span>Selected</span>
            <input type="checkbox" class="mobile-sel" ${st.selected ? "checked" : ""} />
          </div>
          <div class="right">
            <span>Popularity</span>
            <span class="score-value">${r.score.toFixed(1)}</span>
          </div>
        </div>`;
      tr.appendChild(tdDish);

      // Desktop Selected column
      const tdSel = document.createElement("td");
      tdSel.className = "col-sel";
      const cb = document.createElement("input");
      cb.type = "checkbox";
      cb.checked = !!st.selected;
      cb.addEventListener("change", () => st.selected = cb.checked);
      tdSel.appendChild(cb);
      tr.appendChild(tdSel);

      // Desktop Popularity column
      const tdScore = document.createElement("td");
      tdScore.className = "col-score score";
      tdScore.textContent = r.score.toFixed(1);
      tr.appendChild(tdScore);

      // Hook mobile checkbox
      const mobileCb = tdDish.querySelector(".mobile-sel");
      mobileCb.addEventListener("change", () => st.selected = mobileCb.checked);

      tbody.appendChild(tr);
    });
  }

  function getSelections(){
    const selected = [];
    rows.forEach(r => {
      const id = makeId(r.section + "-" + r.dish);
      if (state[id].selected) selected.push(`${r.section}: ${r.dish}${r.lko ? " (LKO)" : ""}`);
    });
    return selected;
  }

  function buildSummary(){
    const name = nameEl.value.trim();
    const now = new Date();
    const selected = getSelections();

    sumName.textContent = name ? `Name: ${name}` : "Name: —";
    sumTime.textContent = `Submitted: ${now.toLocaleString()}`;
    sumSelectedCount.textContent = selected.length;

    selectedList.innerHTML = "";
    if (selected.length === 0) {
      selectedEmpty.style.display = "block";
    } else {
      selectedEmpty.style.display = "none";
      selected.forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        selectedList.appendChild(li);
      });
    }
  }

  function showSummary(){
    editView.classList.add("hidden");
    summaryView.classList.remove("hidden");
  }
  function showEdit(){
    summaryView.classList.add("hidden");
    editView.classList.remove("hidden");
  }

  document.getElementById("submitBtn").addEventListener("click", () => {
    const name = nameEl.value.trim();
    if (!name) {
      statusEl.textContent = "Please enter your name before submitting.";
      nameEl.focus();
      return;
    }
    statusEl.textContent = "";
    buildSummary();
    showSummary();
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  document.getElementById("downloadPdfBtn").addEventListener("click", () => {
    window.print(); // Save as PDF in print dialog
  });

  document.getElementById("backBtn").addEventListener("click", () => {
    showEdit();
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  document.getElementById("clearBtn").addEventListener("click", () => {
    if (!confirm("Clear all selections?")) return;
    Object.keys(state).forEach(id => { state[id].selected=false; });
    statusEl.textContent = "Cleared.";
    renderTable();
  });

  initState();
  renderTable();
</script>
</body>
</html>
