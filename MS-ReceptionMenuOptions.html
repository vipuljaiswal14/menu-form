<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sankalp Manowara Wedding Reception Menu - Veg Gold Selection</title>

  <style>
    :root{
      --border:#e5e7eb; --text:#111827; --muted:#6b7280; --bg:#ffffff;
      --chip:#eef2ff; --chipborder:#c7d2fe; --chiptext:#3730a3;
    }
    body{ margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:var(--text); background:#f8fafc; }
    .wrap{ max-width:1100px; margin:18px auto; padding:0 12px 24px; }
    .card{ background:var(--bg); border:1px solid var(--border); border-radius:14px; box-shadow:0 1px 3px rgba(0,0,0,.04); }
    header.card{ padding:14px 14px 10px; }
    h1{ font-size:20px; margin:0 0 12px; line-height:1.25; }

    .topbar{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .topbar input{
      flex:1 1 280px; border:1px solid var(--border); border-radius:12px;
      padding:11px 12px; font-size:13px; outline:none; background:#fff;
    }
    .btn{
      border:1px solid var(--border); border-radius:12px; padding:11px 14px;
      font-size:13px; cursor:pointer; white-space:nowrap;
      background:#fff; color:var(--text);
    }
    .btn-primary{ background:#111827; color:#fff; border-color:#111827; }
    .btn-primary:hover{ background:#0b1220; }
    .btn:hover{ background:#f9fafb; }
    .status{ margin-top:10px; font-size:12px; color:var(--muted); min-height:16px; }

    .table-wrap{ margin-top:14px; border-radius:14px; overflow:hidden; }
    table{ width:100%; border-collapse:collapse; table-layout:fixed; }
    thead th{
      background:#f9fafb; border-bottom:1px solid var(--border);
      text-align:left; font-size:12px; color:var(--muted); padding:10px 10px;
    }
    tbody td{
      border-bottom:1px solid var(--border); padding:10px 10px;
      font-size:13px; vertical-align:top; background:#fff; word-wrap:break-word;
    }
    tbody tr:last-child td{ border-bottom:none; }

    th.col-cat, td.col-cat{ width:36%; }
    th.col-dish, td.col-dish{ width:46%; }
    th.col-sel, td.col-sel{ width:8%; text-align:center; }
    th.col-score, td.col-score{ width:10%; }

    .cat{ color:var(--muted); font-weight:800; font-size:12px; line-height:1.3; }
    .cat .rule{ font-weight:700; color:#374151; display:block; margin-top:4px; }

    .lko{
      font-size:11px; padding:2px 8px; border-radius:999px;
      background:var(--chip); border:1px solid var(--chipborder);
      color:var(--chiptext); font-weight:700; margin-left:8px; display:inline-block;
    }
    input[type="checkbox"]{ width:18px; height:18px; cursor:pointer; }
    .score{ font-variant-numeric:tabular-nums; }

    /* Hide helper label on desktop */
    .mobile-cat{ display:none; }

    @media (max-width:720px){
      thead{ display:none; }
      table, tbody, tr, td{ display:block; width:100%; }
      tbody tr{ border-bottom:10px solid #f8fafc; }
      tbody td{ border-bottom:none; }
      td.col-cat{ display:none; }
      td.col-dish{ padding:12px 12px 10px; }
      .mobile-cat{ display:block; font-size:12px; color:var(--muted); font-weight:800; margin-bottom:6px; }
      .mobile-cat .rule{ font-weight:700; color:#374151; }
      td.col-sel, td.col-score{
        display:grid; grid-template-columns:1fr auto; gap:10px; align-items:center;
        padding:10px 12px; border-top:1px solid var(--border);
      }
      td.col-sel::before{ content:"Selected"; color:var(--muted); font-size:12px; font-weight:700; }
      td.col-score::before{ content:"Popularity (/5)"; color:var(--muted); font-size:12px; font-weight:700; }
    }

    /* Summary */
    .hidden{ display:none !important; }
    .summary-card{ padding:14px; }
    .summary-header{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:space-between; }
    .summary-header h2{ margin:0; font-size:16px; }
    .summary-meta{ color:var(--muted); font-size:12px; margin-top:6px; }
    .summary-grid{ display:grid; grid-template-columns:1fr; gap:12px; margin-top:12px; }
    .summary-box{ border:1px solid var(--border); border-radius:12px; padding:12px; background:#fff; }
    .summary-box h3{ margin:0 0 8px; font-size:13px; }
    .summary-list{ margin:0; padding-left:18px; }
    .summary-list li{ margin:6px 0; }
    .kpi{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .pill{ display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border:1px solid var(--border); border-radius:999px; font-size:12px; color:var(--muted); background:#fff; }
    .pill strong{ color:var(--text); }

    @media print{
      body{ background:#fff; }
      #editView, #editHeaderActions{ display:none !important; }
      #summaryView{ display:block !important; border:none; box-shadow:none; }
      .card{ border:none; box-shadow:none; }
      .btn{ display:none !important; }
    }
  </style>
</head>

<body>
<div class="wrap">

  <header class="card" id="editView">
    <h1>Sankalp Manowara Wedding Reception Menu - Veg Gold Selection</h1>
    <div class="topbar" id="editHeaderActions">
      <input id="familyMember" type="text" placeholder="Enter your name (required)" />
      <button class="btn btn-primary" id="submitBtn">Submit</button>
      <button class="btn" id="clearBtn">Clear</button>
    </div>
    <div class="status" id="status"></div>

    <div class="card table-wrap">
      <table>
        <thead>
        <tr>
          <th class="col-cat">Category</th>
          <th class="col-dish">Dish</th>
          <th class="col-sel">Selected</th>
          <th class="col-score">Popularity</th>
        </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </header>

  <div class="card hidden" id="summaryView">
    <div class="summary-card">
      <div class="summary-header">
        <div>
          <h2>Submission Summary</h2>
          <div class="summary-meta">
            <span id="sumName"></span> · <span id="sumTime"></span>
          </div>
          <div class="kpi">
            <span class="pill"><strong id="sumSelectedCount">0</strong> selected</span>
          </div>
        </div>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button class="btn btn-primary" id="downloadPdfBtn">Download PDF</button>
          <button class="btn" id="backBtn">Back to edit</button>
        </div>
      </div>

      <div class="summary-grid">
        <div class="summary-box">
          <h3>Selected Dishes</h3>
          <ul class="summary-list" id="selectedList"></ul>
          <div class="summary-meta" id="selectedEmpty" style="display:none;">No dishes selected.</div>
        </div>
      </div>
    </div>
  </div>

</div>

<script>
  // ===== DISPLAY GROUPS (WITHIN-SECTION RULES) =====
  // These are the exact “old structuring” rules you asked to show per sub-category.
  const groupRules = {
    "Welcome Drink · Select 1": "Select 1",

    "Vegetarian Appetizers – Paneer (within Starters)": "Select 1–2",
    "Vegetarian Appetizers – Veg / Awadhi (within Starters)": "Select 1",
    "Vegetarian Appetizers – Fusion (within Starters)": "Select 1–2",

    "Soup · Select 1": "Select 1",
    "Salads · Select 3": "Select 3",

    "Indian Main Course · Select 3": "Select 3",

    "Oriental Main Course – Rice / Noodles": "Select 1",
    "Oriental Main Course – Gravies": "Select 1",
    "Oriental Main Course – Thai": "Optional (only if hotel agrees)"
  };

  // Rows: group is what appears in Category column (with rowSpan)
  // dish cell is ONLY dish name (+LKO chip)
  const rows = [
    // Welcome Drink
    { group:"Welcome Drink · Select 1", dish:"Kesar Badam Milk (Warm)", lko:true, score:4.6 },
    { group:"Welcome Drink · Select 1", dish:"Hot Aam Panna", score:4.2 },
    { group:"Welcome Drink · Select 1", dish:"Strawberry Milk", score:4.0 },
    { group:"Welcome Drink · Select 1", dish:"Jaljeera (Mild)", score:4.1 },

    // Starters - Paneer (Pasanda REMOVED; Achari INCLUDED)
    { group:"Vegetarian Appetizers – Paneer (within Starters)", dish:"Paneer Malai Tikka", score:4.7 },
    { group:"Vegetarian Appetizers – Paneer (within Starters)", dish:"Paneer Amritsari", score:4.6 },
    { group:"Vegetarian Appetizers – Paneer (within Starters)", dish:"Paneer Kurkura", score:4.4 },
    { group:"Vegetarian Appetizers – Paneer (within Starters)", dish:"Achari Paneer Tikka", score:4.5 },

    // Starters - Awadhi
    { group:"Vegetarian Appetizers – Veg / Awadhi (within Starters)", dish:"Veg Galouti Kebab", lko:true, score:4.6 },
    { group:"Vegetarian Appetizers – Veg / Awadhi (within Starters)", dish:"Hara Bhara Kebab", score:4.3 },
    { group:"Vegetarian Appetizers – Veg / Awadhi (within Starters)", dish:"Dahi ke Kebab", score:4.4 },
    { group:"Vegetarian Appetizers – Veg / Awadhi (within Starters)", dish:"Suhal Matar", score:4.2 },

    // Starters - Fusion (includes Chinese options)
    { group:"Vegetarian Appetizers – Fusion (within Starters)", dish:"Corn Cheese Balls", score:4.4 },
    { group:"Vegetarian Appetizers – Fusion (within Starters)", dish:"Cheese & Jalapeño Pockets", score:4.3 },
    { group:"Vegetarian Appetizers – Fusion (within Starters)", dish:"Veg Spring Rolls", score:4.6 },
    { group:"Vegetarian Appetizers – Fusion (within Starters)", dish:"Crispy Fried Vegetables in Burnt Garlic Sauce", score:4.5 },
    { group:"Vegetarian Appetizers – Fusion (within Starters)", dish:"Paneer / Veg Momos", score:4.6 },
    { group:"Vegetarian Appetizers – Fusion (within Starters)", dish:"Chilli Garlic Babycorn", score:4.4 },
    { group:"Vegetarian Appetizers – Fusion (within Starters)", dish:"Honey Chilli Potato", score:4.5 },

    // Soup
    { group:"Soup · Select 1", dish:"Sweet Corn Vegetable Soup", score:4.4 },
    { group:"Soup · Select 1", dish:"Tomato Dhaniya Shorba", score:4.3 },
    { group:"Soup · Select 1", dish:"Hot ’n’ Sour Soup", score:4.6 },
    { group:"Soup · Select 1", dish:"Manchow Soup", score:4.5 },

    // Salads
    { group:"Salads · Select 3", dish:"Green Salad", score:4.2 },
    { group:"Salads · Select 3", dish:"Russian / Waldorf Salad", score:4.3 },
    { group:"Salads · Select 3", dish:"Fruit Chaat", score:4.5 },
    { group:"Salads · Select 3", dish:"Sprout Salad", score:4.0 },
    { group:"Salads · Select 3", dish:"Pasta Salad", score:4.1 },

    // Indian mains (kept as one group - Select 3)
    { group:"Indian Main Course · Select 3", dish:"Paneer Butter Masala", score:4.8 },
    { group:"Indian Main Course · Select 3", dish:"Shahi Paneer", score:4.6 },
    { group:"Indian Main Course · Select 3", dish:"Paneer Lababdar", score:4.7 },
    { group:"Indian Main Course · Select 3", dish:"Paneer Pasanda", score:4.6 },
    { group:"Indian Main Course · Select 3", dish:"Malai Kofta", score:4.7 },
    { group:"Indian Main Course · Select 3", dish:"Navratan Korma", score:4.6 },
    { group:"Indian Main Course · Select 3", dish:"Kaju Curry", score:4.5 },
    { group:"Indian Main Course · Select 3", dish:"Mix Veg Handi", score:4.3 },
    { group:"Indian Main Course · Select 3", dish:"Dum Aloo Banarasi", lko:true, score:4.6 },
    { group:"Indian Main Course · Select 3", dish:"Subi Lahori", lko:true, score:4.4 },

    // Oriental mains: split as requested
    { group:"Oriental Main Course – Rice / Noodles", dish:"Vegetable Hakka Noodles", score:4.6 },
    { group:"Oriental Main Course – Rice / Noodles", dish:"Burnt Garlic Fried Rice", score:4.6 },
    { group:"Oriental Main Course – Rice / Noodles", dish:"Jasmine / Steamed Rice", score:4.4 },

    { group:"Oriental Main Course – Gravies", dish:"Paneer Chilli Gravy", score:4.7 },
    { group:"Oriental Main Course – Gravies", dish:"Veg Manchurian Gravy", score:4.6 },

    { group:"Oriental Main Course – Thai", dish:"Thai Basil Tofu / Vegetables", score:4.5 },
    { group:"Oriental Main Course – Thai", dish:"Thai Green Curry", score:4.6 },
    { group:"Oriental Main Course – Thai", dish:"Thai Red Curry", score:4.5 },

    // Remaining (kept simple)
    { group:"Lentil · Select 1", dish:"Dal Makhani", score:4.9 },
    { group:"Lentil · Select 1", dish:"Dal Tadka", score:4.3 },
    { group:"Lentil · Select 1", dish:"Panchmel Dal", score:4.4 },

    { group:"Rice Preparation · Select 1", dish:"Jeera Rice", score:4.2 },
    { group:"Rice Preparation · Select 1", dish:"Veg Pulao", score:4.4 },
    { group:"Rice Preparation · Select 1", dish:"Peas Pulao", score:4.3 },
    { group:"Rice Preparation · Select 1", dish:"Veg Biryani", lko:true, score:4.6 },

    { group:"Yogurt Preparation · Select 1", dish:"Boondi Raita", score:4.4 },
    { group:"Yogurt Preparation · Select 1", dish:"Mix Veg Raita", score:4.2 },
    { group:"Yogurt Preparation · Select 1", dish:"Pineapple Raita", score:4.0 },

    { group:"Indian Breads · Assorted", dish:"Butter Naan", score:4.8 },
    { group:"Indian Breads · Assorted", dish:"Plain Roti", score:4.6 },
    { group:"Indian Breads · Assorted", dish:"Laccha Paratha", score:4.7 },
    { group:"Indian Breads · Assorted", dish:"Missi Roti", lko:true, score:4.5 },
    { group:"Indian Breads · Assorted", dish:"Garlic Naan", score:4.6 },

    { group:"Indian Dessert · Select 1", dish:"Gajar ka Halwa (Hot)", lko:true, score:4.9 },
    { group:"Indian Dessert · Select 1", dish:"Gulab Jamun", score:4.8 },
    { group:"Indian Dessert · Select 1", dish:"Moong Dal Halwa", score:4.6 },
    { group:"Indian Dessert · Select 1", dish:"Jalebi", score:4.6 },
    { group:"Indian Dessert · Select 1", dish:"Imarti", lko:true, score:4.6 },
    { group:"Indian Dessert · Select 1", dish:"Rabdi", lko:true, score:4.7 },

    { group:"Western Dessert · Select 1", dish:"Chocolate Truffle Pastry", score:4.3 },
    { group:"Western Dessert · Select 1", dish:"Brownie with Chocolate Sauce", score:4.4 },
    { group:"Western Dessert · Select 1", dish:"Red Velvet Pastry", score:4.2 },

    { group:"Ice Cream · Select 1", dish:"Vanilla", score:4.3 },
    { group:"Ice Cream · Select 1", dish:"Strawberry", score:4.1 },
    { group:"Ice Cream · Select 1", dish:"Kesar Pista", score:4.2 },
  ];

  const tbody = document.getElementById("tbody");
  const statusEl = document.getElementById("status");
  const nameEl = document.getElementById("familyMember");

  const editView = document.getElementById("editView");
  const summaryView = document.getElementById("summaryView");
  const sumName = document.getElementById("sumName");
  const sumTime = document.getElementById("sumTime");
  const sumSelectedCount = document.getElementById("sumSelectedCount");
  const selectedList = document.getElementById("selectedList");
  const selectedEmpty = document.getElementById("selectedEmpty");

  const state = {};

  const makeId = (s) => s.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");
  const esc = (s) => String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;");

  function initState(){
    rows.forEach(r => {
      const id = makeId(r.group + "-" + r.dish);
      state[id] = { selected:false };
    });
  }

  function groupCounts(){
    const counts = {};
    rows.forEach(r => counts[r.group] = (counts[r.group] || 0) + 1);
    return counts;
  }

  function renderTable(){
    tbody.innerHTML = "";
    const counts = groupCounts();
    const rendered = {};

    rows.forEach(r => {
      const id = makeId(r.group + "-" + r.dish);
      const st = state[id];

      const tr = document.createElement("tr");

      if (!rendered[r.group]) {
        const tdCat = document.createElement("td");
        tdCat.className = "col-cat";
        tdCat.rowSpan = counts[r.group];

        const rule = groupRules[r.group] ? groupRules[r.group] : "";
        tdCat.innerHTML = `<div class="cat">${esc(r.group)}<span class="rule">${esc(rule)}</span></div>`;
        tr.appendChild(tdCat);
        rendered[r.group] = true;
      }

      const tdDish = document.createElement("td");
      tdDish.className = "col-dish";
      const ruleMobile = groupRules[r.group] ? groupRules[r.group] : "";
      tdDish.innerHTML =
        `<span class="mobile-cat">${esc(r.group)} <span class="rule">· ${esc(ruleMobile)}</span></span>` +
        `<span class="dish-name">${esc(r.dish)}</span>` +
        `${r.lko ? '<span class="lko">LKO</span>' : ''}`;
      tr.appendChild(tdDish);

      const tdSel = document.createElement("td");
      tdSel.className = "col-sel";
      const cb = document.createElement("input");
      cb.type = "checkbox";
      cb.checked = !!st.selected;
      cb.addEventListener("change", () => st.selected = cb.checked);
      tdSel.appendChild(cb);
      tr.appendChild(tdSel);

      const tdScore = document.createElement("td");
      tdScore.className = "col-score score";
      tdScore.textContent = r.score.toFixed(1);
      tr.appendChild(tdScore);

      tbody.appendChild(tr);
    });
  }

  function getSelections(){
    const selected = [];
    rows.forEach(r => {
      const id = makeId(r.group + "-" + r.dish);
      if (state[id].selected) selected.push(`${r.group}: ${r.dish}${r.lko ? " (LKO)" : ""}`);
    });
    return { selected };
  }

  function buildSummary(){
    const name = nameEl.value.trim();
    const now = new Date();
    const { selected } = getSelections();

    sumName.textContent = name ? `Name: ${name}` : "Name: —";
    sumTime.textContent = `Submitted: ${now.toLocaleString()}`;
    sumSelectedCount.textContent = selected.length;

    selectedList.innerHTML = "";
    if (selected.length === 0) {
      selectedEmpty.style.display = "block";
    } else {
      selectedEmpty.style.display = "none";
      selected.forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        selectedList.appendChild(li);
      });
    }
  }

  function showSummary(){
    editView.classList.add("hidden");
    summaryView.classList.remove("hidden");
  }
  function showEdit(){
    summaryView.classList.add("hidden");
    editView.classList.remove("hidden");
  }

  document.getElementById("submitBtn").addEventListener("click", () => {
    const name = nameEl.value.trim();
    if (!name) {
      statusEl.textContent = "Please enter your name before submitting.";
      nameEl.focus();
      return;
    }
    statusEl.textContent = "";
    buildSummary();
    showSummary();
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  document.getElementById("downloadPdfBtn").addEventListener("click", () => window.print());

  document.getElementById("backBtn").addEventListener("click", () => {
    showEdit();
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  document.getElementById("clearBtn").addEventListener("click", () => {
    if (!confirm("Clear all selections?")) return;
    Object.keys(state).forEach(id => { state[id].selected=false; });
    statusEl.textContent = "Cleared.";
    renderTable();
  });

  initState();
  renderTable();
</script>

</body>
</html>
